{% extends "base.html" %}

{% block title %}{{ store.name }}{% endblock %}

{% block content %}
<div class="store-header">
    <div class="store-info">
        <div class="store-icon-large" style="background: {{ store.color }}">{{ store.icon }}</div>
        <div>
            <h1>{{ store.name }}</h1>
            <p class="text-secondary">{{ total }} —Ç–æ–≤–∞—Ä–æ–≤{% if current_category %} –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "{{ current_category }}"{% endif %}</p>
        </div>
    </div>
    
    <form class="search-form" action="{% url 'products:store' store_id %}" method="GET">
        <span class="search-icon">üîç</span>
        <input type="text" name="search" class="search-input" 
               placeholder="–ü–æ–∏—Å–∫: –º–æ–ª–æ–∫–æ, —Å—ã—Ä..." 
               value="{{ request.GET.search }}">
    </form>
</div>

{% if categories %}
<div class="categories-filter">
    <a href="{% url 'products:store' store_id %}" 
       class="category-tag {% if not request.GET.category %}active{% endif %}">
        –í—Å–µ
    </a>
    {% for category in categories %}
    <a href="?category={{ category }}" 
       class="category-tag {% if request.GET.category == category %}active{% endif %}">
        {{ category }}
    </a>
    {% endfor %}
</div>
{% endif %}

{% if products %}
<div class="products-grid">
    {% for product in products %}
    <a href="{% url 'products:product' store_id product.product_id %}" class="product-card">
        <div class="product-name">{{ product.name }}</div>
        <div class="product-price">{{ product.current_price }} ‚ÇΩ</div>
        {% if product.category_name %}
        <div class="product-category">{{ store.name }} - {{ product.category_name }}</div>
        {% endif %}
    </a>
    {% endfor %}
</div>

{% if total_pages > 1 %}
<div class="pagination">
    <div class="pagination-info">
        –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page }} –∏–∑ {{ total_pages }} ({{ total }} —Ç–æ–≤–∞—Ä–æ–≤)
    </div>
    <div class="pagination-nav">
        {% if page > 1 %}
        <a href="?{% if current_category %}category={{ current_category }}&{% endif %}{% if search_query %}search={{ search_query }}&{% endif %}page={{ page|add:'-1' }}" class="btn btn-secondary">
            ‚Üê –ù–∞–∑–∞–¥
        </a>
        {% endif %}
        
        {% if page > 3 %}
        <a href="?{% if current_category %}category={{ current_category }}&{% endif %}{% if search_query %}search={{ search_query }}&{% endif %}page=1" class="page-num">1</a>
        {% if page > 4 %}<span class="page-dots">...</span>{% endif %}
        {% endif %}
        
        {% for p in page_range %}
        <a href="?{% if current_category %}category={{ current_category }}&{% endif %}{% if search_query %}search={{ search_query }}&{% endif %}page={{ p }}" 
           class="page-num {% if p == page %}active{% endif %}">{{ p }}</a>
        {% endfor %}
        
        {% if page < total_pages|add:'-2' %}
        {% if page < total_pages|add:'-3' %}<span class="page-dots">...</span>{% endif %}
        <a href="?{% if current_category %}category={{ current_category }}&{% endif %}{% if search_query %}search={{ search_query }}&{% endif %}page={{ total_pages }}" class="page-num">{{ total_pages }}</a>
        {% endif %}
        
        {% if page < total_pages %}
        <a href="?{% if current_category %}category={{ current_category }}&{% endif %}{% if search_query %}search={{ search_query }}&{% endif %}page={{ page|add:'1' }}" class="btn btn-secondary">
            –í–ø–µ—Ä—ë–¥ ‚Üí
        </a>
        {% endif %}
    </div>
</div>
{% endif %}

{% else %}
<div class="empty-state">
    <div class="empty-icon">üì¶</div>
    <h2>–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h2>
    <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</p>
</div>
{% endif %}

<style>
.store-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.store-info {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.store-icon-large {
    width: 56px;
    height: 56px;
    border-radius: 14px;
    color: white;
    font-size: 1.75rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    justify-content: center;
}

.store-info h1 {
    font-size: 1.5rem;
    margin-bottom: 0.25rem;
}

.text-secondary {
    color: var(--text-secondary);
}

.categories-filter {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 2rem;
}

.category-tag {
    padding: 0.5rem 1rem;
    border-radius: var(--radius);
    background: var(--surface);
    color: var(--text);
    text-decoration: none;
    font-size: 0.875rem;
    transition: all 0.2s;
}

.category-tag:hover {
    background: var(--secondary);
}

.category-tag.active {
    background: var(--primary);
    color: white;
}

.empty-state {
    text-align: center;
    padding: 4rem 2rem;
}

.empty-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
}

.empty-state h2 {
    margin-bottom: 0.5rem;
}

.empty-state p {
    color: var(--text-secondary);
}

.pagination {
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid var(--border);
}

.pagination-info {
    text-align: center;
    color: var(--text-secondary);
    margin-bottom: 1rem;
}

.pagination-nav {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.page-num {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius);
    background: var(--surface);
    color: var(--text);
    text-decoration: none;
    font-weight: 500;
    transition: all 0.2s;
}

.page-num:hover {
    background: var(--secondary);
}

.page-num.active {
    background: var(--primary);
    color: white;
}

.page-dots {
    color: var(--text-secondary);
    padding: 0 0.5rem;
}
</style>
{% endblock %}

